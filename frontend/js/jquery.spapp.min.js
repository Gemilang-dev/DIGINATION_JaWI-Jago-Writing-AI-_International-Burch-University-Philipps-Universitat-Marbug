!function(a){a.spapp=function(b){var c,d={};return c=a.extend({defaultView:a("main#spapp > section:last-child").attr("id"),templateDir:"views/",pageNotFound:!1},b),a("main#spapp > section").each(function(b,c){var e=a(this);d[e.attr("id")]={view:e.attr("id"),load:e.data("load"),onCreate:function(){},onReady:function(){}}}),this.route=function(b){a.extend(d[b.view],b)},this.run=function(){var e=function(){var b=location.hash.slice(1),e=b.split("/")[0],f=d[e],g=a("#"+e);if(g.length&&f){if(a("main#spapp > section").hide(),g.show(),g.hasClass("spapp-created"))f.onReady();else if(g.addClass("spapp-created"),f.load)g.load(c.templateDir+f.load,function(){f.onCreate(),f.onReady()});else f.onCreate(),f.onReady()}else c.pageNotFound?window.location.hash=c.pageNotFound:console.log(e+" not defined")};window.addEventListener("hashchange",function(){e()}),window.location.hash?e():window.location.hash=c.defaultView},this}}(jQuery);
